import React, { useState, useEffect } from 'react'
import { useNavigate } from 'react-router-dom'
import styled from 'styled-components'
import { motion, AnimatePresence } from 'framer-motion'
import TrafficInfoGrid from '../components/TrafficInfoGrid'
import axios from 'axios'

const Container = styled.div`
  min-height: 100vh;
  background: linear-gradient(
    135deg, 
    #87CEEB 0%,    /* Â§©ËìùËâ≤ */
    #98E4D6 20%,   /* ËñÑËç∑Áªø */
    #F4E285 40%,   /* ÊµÖÈªÑËâ≤ */
    #FFB347 60%,   /* ÈáëÊ©ôËâ≤ */
    #FF8C69 80%,   /* ÁèäÁëöËâ≤ */
    #FFA07A 100%   /* ÊµÖÊ©ôËâ≤ */
  );
  position: relative;
  overflow-x: hidden;
`

const Header = styled.div`
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  position: sticky;
  top: 0;
  z-index: 100;
`

const BackButton = styled(motion.button)`
  position: absolute;
  top: 10px;
  left: 20px;
  background: linear-gradient(45deg, #87CEEB, #98E4D6);
  border: none;
  border-radius: 30px;
  padding: 12px 20px;
  font-size: 16px;
  color: #2E8B57;
  cursor: pointer;
  box-shadow: 0 6px 20px rgba(135, 206, 235, 0.4);
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: 600;
  z-index: 1000;
  
  &:hover {
    background: linear-gradient(45deg, #98E4D6, #87CEEB);
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(135, 206, 235, 0.5);
  }
`

const Title = styled.h1`
  text-align: center;
  font-size: 36px;
  color: #FF6B35;
  margin: 20px 0;
  font-family: 'ÂçéÊñáË°åÊ•∑', 'STXingkai', 'KaiTi', 'SimKai', cursive;
  text-shadow: 2px 2px 4px rgba(255, 107, 53, 0.3);
  
  &::before {
    content: 'üöå ';
  }
  
  &::after {
    content: ' ‚úàÔ∏è';
  }
`

const MainNavigation = styled.div`
  display: flex;
  justify-content: center;
  margin-bottom: 0;
  border-bottom: 2px solid #e0e0e0;
`

const MainNavItem = styled(motion.button)<{ active: boolean }>`
  background: ${props => props.active ? '#FF6B35' : 'transparent'};
  color: ${props => props.active ? 'white' : '#FF6B35'};
  border: none;
  padding: 15px 30px;
  font-size: 18px;
  font-weight: 600;
  cursor: pointer;
  border-radius: 25px 25px 0 0;
  transition: all 0.3s ease;
  position: relative;
  margin: 0 5px;
  
  &:hover {
    background: ${props => props.active ? '#FF6B35' : 'rgba(255, 107, 53, 0.1)'};
    transform: translateY(-2px);
  }
  
  &::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    right: 0;
    height: 2px;
    background: ${props => props.active ? '#FF6B35' : 'transparent'};
  }
`

const SubNavigation = styled.div`
  display: flex;
  justify-content: center;
  background: #f8f9fa;
  padding: 10px 0;
  border-bottom: 1px solid #e0e0e0;
`

const SubNavItem = styled(motion.button)<{ active: boolean }>`
  background: ${props => props.active ? '#FFB347' : 'transparent'};
  color: ${props => props.active ? 'white' : '#666'};
  border: none;
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
  border-radius: 20px;
  margin: 0 5px;
  transition: all 0.3s ease;
  
  &:hover {
    background: ${props => props.active ? '#FFB347' : 'rgba(255, 179, 71, 0.2)'};
  }
`

const Content = styled.div`
  max-width: 1200px;
  margin: 0 auto;
  padding: 40px 20px;
`

const ContentSection = styled(motion.div)`
  background: rgba(255, 255, 255, 0.95);
  border-radius: 20px;
  padding: 40px;
  margin-bottom: 30px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
`

const SectionTitle = styled.h2`
  color: #FF6B35;
  font-size: 28px;
  margin-bottom: 20px;
  border-bottom: 3px solid #FFB347;
  padding-bottom: 10px;
  display: inline-block;
`

const ContentGrid = styled.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 30px;
  margin-top: 30px;
`

const ContentCard = styled(motion.div)`
  background: #f8f9fa;
  border-radius: 15px;
  padding: 25px;
  border-left: 5px solid #FFB347;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  
  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
  }
`

const CardTitle = styled.h3`
  color: #FF6B35;
  font-size: 22px;
  margin-bottom: 15px;
  display: flex;
  align-items: center;
  gap: 10px;
`

const CardContent = styled.div`
  color: #666;
  line-height: 1.6;
  font-size: 16px;
`

const DownloadButton = styled(motion.button)`
  background: linear-gradient(45deg, #FF6B35, #FFB347);
  color: white;
  border: none;
  border-radius: 30px;
  padding: 15px 30px;
  font-size: 18px;
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
  display: flex;
  align-items: center;
  gap: 10px;
  margin: 20px auto;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
  }
`

const ComingSoonBadge = styled.div`
  background: #FFB347;
  color: white;
  padding: 5px 15px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: 600;
  display: inline-block;
  margin-left: 10px;
`

const ChecklistContainer = styled.div`
  max-width: 1200px;
  margin: 0 auto;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
  gap: 30px;
`

const ChecklistSection = styled(motion.div)`
  background: rgba(255, 255, 255, 0.95);
  border-radius: 20px;
  padding: 30px;
  box-shadow: 0 10px 30px rgba(255, 165, 0, 0.2);
  backdrop-filter: blur(10px);
  border: 2px solid rgba(255, 165, 0, 0.1);
`

const ChecklistSectionHeader = styled.div`
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 20px;
  padding-bottom: 12px;
  border-bottom: 2px solid #FFB347;
`

const ChecklistSectionIcon = styled.div`
  font-size: 24px;
`

const ChecklistSectionTitle = styled.h2`
  font-size: 22px;
  color: #FF6B35;
  margin: 0;
  font-weight: 700;
`

const ChecklistItem = styled.div<{ checked: boolean }>`
  display: flex;
  align-items: flex-start;
  gap: 12px;
  margin-bottom: 15px;
  padding: 10px;
  border-radius: 10px;
  background: ${props => props.checked ? 'rgba(255, 179, 71, 0.1)' : 'transparent'};
  transition: all 0.3s ease;
  
  &:hover {
    background: rgba(255, 179, 71, 0.1);
  }
`

const CheckBox = styled.div<{ checked: boolean }>`
  width: 20px;
  height: 20px;
  border: 2px solid #FFB347;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  background: ${props => props.checked ? '#FFB347' : 'white'};
  color: white;
  font-size: 12px;
  font-weight: bold;
  transition: all 0.3s ease;
  flex-shrink: 0;
  margin-top: 2px;
  
  &:hover {
    background: ${props => props.checked ? '#FF6B35' : '#FFB347'};
    transform: scale(1.1);
  }
`

const ItemText = styled.div<{ checked: boolean }>`
  font-size: 16px;
  color: ${props => props.checked ? '#999' : '#555'};
  text-decoration: ${props => props.checked ? 'line-through' : 'none'};
  line-height: 1.5;
  transition: all 0.3s ease;
`

const ProgressBar = styled.div`
  background: rgba(255, 255, 255, 0.8);
  border-radius: 15px;
  padding: 20px;
  margin-bottom: 30px;
  text-align: center;
  backdrop-filter: blur(10px);
  box-shadow: 0 8px 25px rgba(255, 165, 0, 0.2);
`

const ProgressText = styled.div`
  font-size: 18px;
  color: #FF6B35;
  font-weight: 600;
  margin-bottom: 10px;
`

const ProgressTrack = styled.div`
  background: #e0e0e0;
  border-radius: 10px;
  height: 20px;
  overflow: hidden;
  position: relative;
`

const ProgressFill = styled.div<{ percentage: number }>`
  background: linear-gradient(45deg, #FF6B35, #FFB347);
  height: 100%;
  width: ${props => props.percentage}%;
  transition: width 0.5s ease;
  border-radius: 10px;
`

interface TrafficCard {
  id: number
  title: string
  icon: string
  content: string
  category: string
  subcategory?: string
  order_index: number
  created_at: string
  updated_at: string
}

// Â∑°Á§ºÊ∏ÖÂçïÊï∞ÊçÆ
const checklistData = [
  {
    id: 'pre-departure',
    title: 'Âá∫Ë°åÂâçÂáÜÂ§á',
    icon: '‚úàÔ∏è',
    items: [
      'Êä§ÁÖß/Á≠æËØÅÂäûÁêÜ',
      'Êú∫Á•®È¢ÑËÆ¢',
      '‰ΩèÂÆøÈ¢ÑËÆ¢',
      'ÊóÖË°å‰øùÈô©Ë¥≠‰π∞',
      'Êó•ÂÖÉÂÖëÊç¢/Èì∂Ë°åÂç°ÂáÜÂ§á',
      'ÊâãÊú∫Âç°/ÈöèË∫´WiFiÂáÜÂ§á',
      'Ë°åÊùéÊâìÂåÖÔºàË°£Áâ©„ÄÅËçØÂìÅ„ÄÅÂÖÖÁîµÂô®Á≠âÔºâ',
      'ÈáçË¶ÅÊñá‰ª∂Â§çÂç∞/ÁîµÂ≠êÂ§á‰ªΩ'
    ]
  },
  {
    id: 'flight-transport',
    title: 'Êú∫Á•®‰∏é‰∫§ÈÄö',
    icon: 'üöå',
    items: [
      'ÈÄâÊã©Âá∫ÂèëÂüéÂ∏ÇÂèäËà™Áè≠',
      'Êú∫Á•®Ë¥≠‰π∞Âπ≥Âè∞ÊØî‰ª∑',
      '‰∫ÜËß£Ë°åÊùéÊâòËøêËßÑÂÆö',
      'ÁÜüÊÇâÂÄºÊú∫‰∏éÁôªÊú∫ÊµÅÁ®ã',
      '‰∫ÜËß£Êó•Êú¨ÂÖ•Â¢ÉÊµÅÁ®ã',
      'ÂáÜÂ§á‰∫§ÈÄöÂç°Ë¥≠‰π∞',
      'Êü•ËØ¢Êú∫Âú∫Êç¢‰πò‰ø°ÊÅØ'
    ]
  },
  {
    id: 'japan-itinerary',
    title: 'Êó•Êú¨ÂõΩÂÜÖË°åÁ®ã',
    icon: 'üéå',
    items: [
      'Á°ÆÂÆöÊú∫Âú∫Âà∞È´òÊùæÁöÑ‰∫§ÈÄöÊñπÂºè',
      'Êü•ËØ¢ËØ¶ÁªÜÊç¢‰πòÊµÅÁ®ã',
      'Â≠¶‰π†Ë¥≠Á•®Êú∫‰ΩøÁî®ÊñπÊ≥ï',
      'ËßÑÂàíÊôØÁÇπ‰∫§ÈÄöË∑ØÁ∫ø',
      'ÂáÜÂ§áÂêÑÁßçË∑ØÁ∫øÊñπÊ°à',
      '‰∏ãËΩΩÁõ∏ÂÖ≥‰∫§ÈÄöAPP',
      'Êî∂ËóèÂÆûÁî®ÁΩëÁ´ôÈìæÊé•'
    ]
  },
  {
    id: 'schedule-budget',
    title: 'Ë°åÁ®ãÂÆâÊéí‰∏éÈ¢ÑÁÆó',
    icon: 'üìÖ',
    items: [
      'Âà∂ÂÆöÊØèÊó•Ë°åÁ®ãËÆ°Âàí',
      'È¢ÑÁÆóÂàÜÈÖçÔºà‰∫§ÈÄö„ÄÅ‰ΩèÂÆø„ÄÅÈ§êÈ•ÆÁ≠âÔºâ',
      'È¢ÑËÆ¢ÁÉ≠Èó®ÊôØÁÇπÈó®Á•®',
      'ÂÆâÊéíË¥≠Áâ©Êó∂Èó¥ÂíåÂú∞ÁÇπ',
      'Âà∂ÂÆöÂ∫îÊÄ•È¢ÑÊ°à',
      'ÂáÜÂ§áÁ¶ªÂ¢ÉÁõ∏ÂÖ≥ÂÆâÊéí'
    ]
  },
  {
    id: 'useful-tools',
    title: 'ÂÆûÁî®Â∑•ÂÖ∑Êé®Ëçê',
    icon: 'üõ†Ô∏è',
    items: [
      'Google Maps ÔºàË∑ØÁ∫øËßÑÂàíÔºâ',
      'Yahoo!‰πòÊç¢Ê°àÂÜÖ ÔºàÊç¢‰πòÊü•ËØ¢Ôºâ',
      'Google Translate ÔºàËØ≠Ë®ÄÁøªËØëÔºâ',
      'Êó•Êú¨ÊóÖÊ∏∏APP‰∏ãËΩΩ',
      'Â§©Ê∞îÈ¢ÑÊä•Êü•ËØ¢',
      'Ê±áÁéáÊü•ËØ¢Â∑•ÂÖ∑',
      'Á¥ßÊÄ•ËÅîÁ≥ªÊñπÂºèËÆ∞ÂΩï'
    ]
  },
  {
    id: 'pilgrimage-specific',
    title: 'Âú£Âú∞Â∑°Á§º‰∏ìÈ°π',
    icon: 'üåü',
    items: [
      'Â•≥Êú®Â≤õ‰∫§ÈÄöÂèäÊôØÁÇπ‰ø°ÊÅØ',
      'Áî∑Êú®Â≤õ‰∫§ÈÄöÂèäÊôØÁÇπ‰ø°ÊÅØ',
      'Áõ¥Â≤õ‰∫§ÈÄöÂèäÊôØÁÇπ‰ø°ÊÅØ',
      'ÊãçÁÖßÂú∞ÁÇπÊ†áËÆ∞',
      'ÂºÄÊîæÊó∂Èó¥Á°ÆËÆ§',
      'Èó®Á•®ÊàñÈ¢ÑÁ∫¶‰ø°ÊÅØ',
      'ÁâπÊÆä‰∫§ÈÄöÂ∑•ÂÖ∑ÂÆâÊéí'
    ]
  }
]

const TrafficPage: React.FC = () => {
  const navigate = useNavigate()
  const [activeMainTab, setActiveMainTab] = useState<'international' | 'domestic' | 'checklist'>('international')
  const [activeSubTab, setActiveSubTab] = useState<'guangzhou' | 'other'>('guangzhou')
  const [activeDomesticTab, setActiveDomesticTab] = useState<'kansai-takamatsu' | 'other'>('kansai-takamatsu')
  const [checkedItems, setCheckedItems] = useState<Set<string>>(new Set())
  const [isDownloading, setIsDownloading] = useState(false)
  // ‰∫§ÈÄöÂç°ÁâáÊï∞ÊçÆ
  const [trafficCardsData, setTrafficCardsData] = useState<TrafficCard[]>([])
  useEffect(() => {
    fetch('/trafficdata/InDeparture/traffic_cards.json')
      .then(res => res.json())
      .then(data => setTrafficCardsData(data))
      .catch(() => setTrafficCardsData([]))
  }, [])

  const handleBack = () => {
    navigate('/contents')
  }

  const handleItemCheck = (sectionId: string, itemIndex: number) => {
    const itemId = `${sectionId}-${itemIndex}`
    setCheckedItems(prev => {
      const newSet = new Set(prev)
      if (newSet.has(itemId)) {
        newSet.delete(itemId)
      } else {
        newSet.add(itemId)
      }
      return newSet
    })
  }

  const handleDownloadPDF = async () => {
    setIsDownloading(true)
    try {
      // Áõ¥Êé•‰∏ãËΩΩpublic/filesÁõÆÂΩï‰∏ãÁöÑPDFÊñá‰ª∂
      const response = await fetch('/files/È∏üÁôΩÂ≤õÂ∑°Á§ºlist.pdf')
      
      if (!response.ok) {
        throw new Error('‰∏ãËΩΩÂ§±Ë¥•')
      }

      const blob = await response.blob()
      const url = window.URL.createObjectURL(blob)
      const a = document.createElement('a')
      a.style.display = 'none'
      a.href = url
      a.download = 'È∏üÁôΩÂ≤õÂ∑°Á§ºlist.pdf'
      document.body.appendChild(a)
      a.click()
      window.URL.revokeObjectURL(url)
      document.body.removeChild(a)
    } catch (error) {
      console.error('‰∏ãËΩΩÂ§±Ë¥•:', error)
      alert('‰∏ãËΩΩÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÂÜçËØï')
    } finally {
      setIsDownloading(false)
    }
  }

  const getTotalItems = () => {
    return checklistData.reduce((total, section) => total + section.items.length, 0)
  }

  const getCheckedCount = () => {
    return checkedItems.size
  }

  const getProgress = () => {
    const total = getTotalItems()
    const checked = getCheckedCount()
    return total > 0 ? (checked / total) * 100 : 0
  }



  const renderInternationalContent = () => {
    const internationalCards = activeSubTab === 'guangzhou'
      ? trafficCardsData.filter(card => card.category === 'international' && card.subcategory === 'guangzhou')
      : []

    return (
      <AnimatePresence mode="wait">
        <motion.div
          key="international"
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          exit={{ opacity: 0, y: -20 }}
          transition={{ duration: 0.3 }}
        >
          <SubNavigation>
            <SubNavItem 
              active={activeSubTab === 'guangzhou'} 
              onClick={() => setActiveSubTab('guangzhou')}
            >
              ÂπøÂ∑û-Êò•ÁßãËà™Á©∫
            </SubNavItem>
            <SubNavItem 
              active={activeSubTab === 'other'} 
              onClick={() => setActiveSubTab('other')}
            >
              ÂÖ∂‰ªñÂüéÂ∏Ç
              <ComingSoonBadge>Âç≥Â∞ÜÂºÄÊîæ</ComingSoonBadge>
            </SubNavItem>
          </SubNavigation>
          
          <Content>
            {activeSubTab === 'guangzhou' && internationalCards.length > 0 ? (
              <TrafficInfoGrid 
                cards={internationalCards} 
                title="ÂõΩÈôÖÂá∫Ë°åÊîªÁï• - ÂπøÂ∑ûÊò•ÁßãËà™Á©∫"
              />
            ) : activeSubTab === 'guangzhou' && (
              <div style={{ textAlign: 'center', padding: '40px', color: '#666' }}>
                ÊöÇÊó†ÊîªÁï•Êï∞ÊçÆ
              </div>
            )}
            
            {activeSubTab === 'other' && (
              <ContentSection>
                <SectionTitle>ÂÖ∂‰ªñÂüéÂ∏ÇÊîªÁï•</SectionTitle>
                <div style={{ textAlign: 'center', padding: '60px 0' }}>
                  <div style={{ fontSize: '48px', marginBottom: '20px' }}>üöß</div>
                  <h3 style={{ color: '#FF6B35', marginBottom: '15px' }}>ÂÜÖÂÆπÂáÜÂ§á‰∏≠</h3>
                  <p style={{ color: '#666', fontSize: '18px' }}>
                    Êàë‰ª¨Ê≠£Âú®Êï¥ÁêÜÊõ¥Â§öÂüéÂ∏ÇÁöÑ‰∫§ÈÄöÊîªÁï•ÔºåÂåÖÊã¨Ôºö
                    <br />
                    Âåó‰∫¨„ÄÅ‰∏äÊµ∑„ÄÅÊ∑±Âú≥„ÄÅÊàêÈÉΩ„ÄÅÊù≠Â∑ûÁ≠â‰∏ªË¶ÅÂüéÂ∏Ç
                  </p>
                </div>
              </ContentSection>
            )}
          </Content>
        </motion.div>
      </AnimatePresence>
    )
  }

  const renderDomesticContent = () => {
    const domesticCards = trafficCardsData.filter(card => card.category === 'domestic' && card.subcategory === 'kansai-takamatsu')
    return (
      <AnimatePresence mode="wait">
        <motion.div
          key="domestic"
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          exit={{ opacity: 0, y: -20 }}
          transition={{ duration: 0.3 }}
        >
          <SubNavigation>
            <SubNavItem 
              active={activeDomesticTab === 'kansai-takamatsu'} 
              onClick={() => setActiveDomesticTab('kansai-takamatsu')}
            >
              ÂÖ≥Ë•øÊú∫Âú∫‚ÜíÈ´òÊùæÔºàÁîµËΩ¶Ôºâ
            </SubNavItem>
            <SubNavItem 
              active={activeDomesticTab === 'other'} 
              onClick={() => setActiveDomesticTab('other')}
            >
              ÂÖ∂‰ªñË∑ØÁ∫ø
              <ComingSoonBadge>Âç≥Â∞ÜÂºÄÊîæ</ComingSoonBadge>
            </SubNavItem>
          </SubNavigation>
          <Content>
            {activeDomesticTab === 'kansai-takamatsu' && (
              <ContentGrid>
                {domesticCards.sort((a, b) => a.order_index - b.order_index).map(card => (
                  <ContentCard
                    key={card.id}
                    initial={{ opacity: 0, y: 20 }}
                    animate={{ opacity: 1, y: 0 }}
                    transition={{ delay: 0.1 * card.order_index }}
                  >
                    <CardTitle>
                      <span>{card.icon}</span>
                      {card.title}
                    </CardTitle>
                    <CardContent>
                      {card.content.split('\n').map((line, idx) => <div key={idx}>{line}</div>)}
                    </CardContent>
                  </ContentCard>
                ))}
              </ContentGrid>
            )}
            {activeDomesticTab === 'other' && (
              <ContentSection>
                <SectionTitle>ÂÖ∂‰ªñË∑ØÁ∫øÊîªÁï•</SectionTitle>
                <div style={{ textAlign: 'center', padding: '60px 0' }}>
                  <div style={{ fontSize: '48px', marginBottom: '20px' }}>üöß</div>
                  <h3 style={{ color: '#FF6B35', marginBottom: '15px' }}>ÂÜÖÂÆπÂáÜÂ§á‰∏≠</h3>
                  <p style={{ color: '#666', fontSize: '18px' }}>
                    Êàë‰ª¨Ê≠£Âú®Êï¥ÁêÜÊõ¥Â§ö‰∫§ÈÄöÊñπÂºèÔºåÂåÖÊã¨Ôºö<br />
                    Â§ßÂ∑¥Ë∑ØÁ∫ø„ÄÅËΩÆËàπË∑ØÁ∫ø„ÄÅÁßüËΩ¶Ëá™È©æÁ≠â
                  </p>
                </div>
              </ContentSection>
            )}
          </Content>
        </motion.div>
      </AnimatePresence>
    )
  }

  const renderChecklistContent = () => {
    return (
      <AnimatePresence mode="wait">
        <motion.div
          key="checklist"
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          exit={{ opacity: 0, y: -20 }}
          transition={{ duration: 0.3 }}
        >
          <Content>
            <ContentSection>
              <SectionTitle>Â∑°Á§º‰ªªÂä°Ê∏ÖÂçï</SectionTitle>
              <div style={{ textAlign: 'center', marginBottom: '40px' }}>
                <p style={{ fontSize: '18px', color: '#666', marginBottom: '30px' }}>
                  ‰∏∫Â∏ÆÂä©Èõ∂ÁªèÈ™åÁΩëÂèãÈ°∫Âà©ÂÆåÊàêÂú£Âú∞Â∑°Á§ºËÆ°ÂàíÔºåÊàë‰ª¨ÁâπÂà´Âà∂‰Ωú‰∫ÜËØ¶ÁªÜÁöÑ‰ªªÂä°Ê∏ÖÂçï„ÄÇ
                  <br />
                  Âª∫ËÆÆ‰∏ãËΩΩPDFÁâàÊú¨Âπ∂ÊâìÂç∞ÔºåÈÄêÈ°πÊâìÂãæÁ°Æ‰øùÊØè‰∏ÄÊ≠•ÈÉΩ‰∏çÈÅóÊºè„ÄÇ
                </p>
                <DownloadButton
                  onClick={handleDownloadPDF}
                  disabled={isDownloading}
                  whileHover={{ scale: 1.05 }}
                  whileTap={{ scale: 0.95 }}
                >
                  {isDownloading ? 'üìÑ ‰∏ãËΩΩ‰∏≠...' : 'üìÑ ‰∏ãËΩΩÂ∑°Á§ºÊ∏ÖÂçï'}
                </DownloadButton>
              </div>

              <ProgressBar>
                <ProgressText>
                  ÂÆåÊàêËøõÂ∫¶Ôºö{getCheckedCount()} / {getTotalItems()} È°π ({Math.round(getProgress())}%)
                </ProgressText>
                <ProgressTrack>
                  <ProgressFill percentage={getProgress()} />
                </ProgressTrack>
              </ProgressBar>

              <ChecklistContainer>
                {checklistData.map((section) => (
                  <ChecklistSection
                    key={section.id}
                    initial={{ opacity: 0, y: 50 }}
                    animate={{ opacity: 1, y: 0 }}
                    transition={{ duration: 0.6 }}
                  >
                    <ChecklistSectionHeader>
                      <ChecklistSectionIcon>{section.icon}</ChecklistSectionIcon>
                      <ChecklistSectionTitle>{section.title}</ChecklistSectionTitle>
                    </ChecklistSectionHeader>
                    
                    {section.items.map((item, index) => {
                      const itemId = `${section.id}-${index}`
                      const isChecked = checkedItems.has(itemId)
                      
                      return (
                        <ChecklistItem key={index} checked={isChecked}>
                          <CheckBox 
                            checked={isChecked}
                            onClick={() => handleItemCheck(section.id, index)}
                          >
                            {isChecked && '‚úì'}
                          </CheckBox>
                          <ItemText checked={isChecked}>
                            {item}
                          </ItemText>
                        </ChecklistItem>
                      )
                    })}
                  </ChecklistSection>
                ))}
              </ChecklistContainer>
            </ContentSection>
          </Content>
        </motion.div>
      </AnimatePresence>
    )
  }

  return (
    <Container>
      <Header>
        <div style={{ position: 'relative' }}>
          <BackButton
            onClick={handleBack}
            whileHover={{ scale: 1.05 }}
            whileTap={{ scale: 0.95 }}
          >
            üè† ËøîÂõûÁõÆÂΩï
          </BackButton>
          <Title>Summer Pockets ‰∫§ÈÄöÊîªÁï•</Title>
        </div>
        <MainNavigation>
          <MainNavItem 
            active={activeMainTab === 'international'} 
            onClick={() => setActiveMainTab('international')}
          >
            ÂõΩÈôÖÂá∫Âèë
          </MainNavItem>
          <MainNavItem 
            active={activeMainTab === 'domestic'} 
            onClick={() => setActiveMainTab('domestic')}
          >
            Êó•Êú¨ÂõΩÂÜÖÂá∫Âèë
          </MainNavItem>
          <MainNavItem 
            active={activeMainTab === 'checklist'} 
            onClick={() => setActiveMainTab('checklist')}
          >
            Â∑°Á§º‰ªªÂä°Ê∏ÖÂçï
          </MainNavItem>
        </MainNavigation>
      </Header>

      {activeMainTab === 'international' && renderInternationalContent()}
      {activeMainTab === 'domestic' && renderDomesticContent()}
      {activeMainTab === 'checklist' && renderChecklistContent()}

    </Container>
  )
}

export default TrafficPage 