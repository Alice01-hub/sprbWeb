Summer Pockets 圣地巡礼网站设计方案
🎯 项目概述
设计目的
设计一个Summer Pockets圣地巡礼的打卡网站，帮助游戏玩家重回那个夏天，顺利完成第一次巡礼，留下美好回忆。同时提供平台让玩家分享巡礼经历和有趣事情。
核心功能
1. 首页 - 《夏日口袋打卡日记》封面界面
2. 交通篇 - 巡礼交通指南（第一版暂时占位）
3. 打卡篇 - 三岛地图交互系统
4. 打卡点详情 - 图文介绍和BGM播放
5. 管理员系统 - 内容管理和数据维护后台
🔐 管理员系统功能概述
核心管理功能
1. 用户认证系统 - 安全的JWT登录认证
2. 岛屿管理 - 新增、编辑、删除岛屿信息
3. 打卡点管理 - 在地图上添加/删除标记，编辑详细信息
4. 文件管理 - 上传、替换、删除图片和音频文件
5. 数据统计 - 访问量统计、热门打卡点分析
6. 内容审核 - 图片和文字内容的质量控制
地图编辑功能
• 交互式地图标记 - 点击地图添加新打卡点
• 拖拽调整位置 - 直接在地图上调整标记位置
• 批量操作 - 选择多个标记进行批量删除或修改
• 实时预览 - 修改后立即在地图上看到效果
内容编辑功能
• 富文本编辑器 - 支持格式化文本编辑
• 图片上传预览 - 拖拽上传，实时预览效果
• 音频文件管理 - BGM文件上传和播放测试
• 数据验证 - 确保数据完整性和格式正确
权限与安全
• 角色权限控制 - 不同管理员角色的权限限制
• 操作日志记录 - 记录所有管理操作便于审计
• 数据备份 - 定期备份重要数据
• 安全认证 - JWT token过期和刷新机制
🛠 技术栈选择
前端框架
• React + TypeScript - 现代化组件开发
• Vite - 快速构建工具
• React Router - 路由管理
地图服务
• Google Maps JavaScript API - 地图集成和交互
样式方案
• Styled Components - CSS-in-JS样式管理
• CSS Modules - 局部样式隔离
• 响应式设计 - 移动端适配
数据管理
• 前端数据: 静态JSON文件 + 本地存储
• 后端数据库: MongoDB/PostgreSQL - 支持管理员系统
• 文件存储: 本地文件系统/云存储 - 图片和音频资源
后端框架
• Node.js + Express - RESTful API服务
• TypeScript - 全栈类型安全
• JWT认证 - 管理员身份验证
• Multer - 文件上传处理
音频处理
• Web Audio API - BGM播放控制
• 音频预加载 - 优化播放体验
📁 项目结构设计
sprb-web/
├── public/
│   ├── images/
│   │   ├── cg/              # 游戏CG图片
│   │   ├── real/            # 实地拍摄照片
│   │   ├── ui/              # UI元素图片
│   │   └── diary-cover.jpg  # 日记本封面
│   ├── audio/
│   │   └── bgm/             # 背景音乐文件
│   ├── data/
│   │   ├── islands.json     # 岛屿基础数据（前端缓存）
│   │   ├── spots.json       # 打卡点详细数据（前端缓存）
│   │   └── config.json      # 配置信息
│   └── favicon.ico
├── src/
│   ├── components/
│   │   ├── common/          # 通用组件
│   │   │   ├── Layout.tsx
│   │   │   ├── Navigation.tsx
│   │   │   └── Loading.tsx
│   │   ├── maps/            # 地图相关组件
│   │   │   ├── OverviewMap.tsx
│   │   │   ├── IslandMap.tsx
│   │   │   ├── SpotMarker.tsx
│   │   │   └── SpotTooltip.tsx
│   │   ├── diary/           # 日记本相关组件
│   │   │   ├── DiaryCover.tsx
│   │   │   └── DiaryPage.tsx
│   │   └── audio/           # 音频相关组件
│   │       ├── BGMPlayer.tsx
│   │       └── AudioController.tsx
│   ├── pages/
│   │   ├── HomePage.tsx     # 首页
│   │   ├── DiaryPage.tsx    # 日记主页
│   │   ├── TrafficPage.tsx  # 交通篇
│   │   ├── CheckinPage.tsx  # 打卡篇总览
│   │   ├── IslandPage.tsx   # 岛屿详情页
│   │   └── SpotPage.tsx     # 打卡点详情页
│   ├── hooks/
│   │   ├── useGoogleMaps.ts # 地图集成hook
│   │   ├── useAudio.ts      # 音频控制hook
│   │   └── useSpotData.ts   # 数据获取hook
│   ├── utils/
│   │   ├── mapHelpers.ts    # 地图工具函数
│   │   ├── audioUtils.ts    # 音频工具函数
│   │   └── dataLoader.ts    # 数据加载器
│   ├── styles/
│   │   ├── global.css       # 全局样式
│   │   ├── components/      # 组件样式
│   │   └── pages/           # 页面样式
│   ├── types/
│   │   ├── island.ts        # 岛屿类型定义
│   │   ├── spot.ts          # 打卡点类型定义
│   │   └── map.ts           # 地图类型定义
│   ├── App.tsx
│   ├── main.tsx
│   └── vite-env.d.ts
├── admin/                   # 管理员系统目录
│   ├── frontend/            # 管理员前端
│   │   ├── src/
│   │   │   ├── components/
│   │   │   │   ├── auth/    # 认证组件
│   │   │   │   │   ├── LoginForm.tsx
│   │   │   │   │   └── AuthGuard.tsx
│   │   │   │   ├── dashboard/  # 仪表板组件
│   │   │   │   │   ├── Dashboard.tsx
│   │   │   │   │   ├── Statistics.tsx
│   │   │   │   │   └── QuickActions.tsx
│   │   │   │   ├── spots/   # 打卡点管理组件
│   │   │   │   │   ├── SpotList.tsx
│   │   │   │   │   ├── SpotEditor.tsx
│   │   │   │   │   ├── SpotMap.tsx
│   │   │   │   │   └── ImageUploader.tsx
│   │   │   │   ├── islands/ # 岛屿管理组件
│   │   │   │   │   ├── IslandList.tsx
│   │   │   │   │   └── IslandEditor.tsx
│   │   │   │   └── common/  # 通用管理组件
│   │   │   │       ├── FileUpload.tsx
│   │   │   │       ├── RichTextEditor.tsx
│   │   │   │       └── ConfirmDialog.tsx
│   │   │   ├── pages/
│   │   │   │   ├── LoginPage.tsx
│   │   │   │   ├── DashboardPage.tsx
│   │   │   │   ├── SpotsPage.tsx
│   │   │   │   ├── IslandsPage.tsx
│   │   │   │   └── SettingsPage.tsx
│   │   │   ├── hooks/
│   │   │   │   ├── useAuth.ts
│   │   │   │   ├── useApi.ts
│   │   │   │   └── useFileUpload.ts
│   │   │   ├── services/
│   │   │   │   ├── authService.ts
│   │   │   │   ├── apiService.ts
│   │   │   │   └── fileService.ts
│   │   │   ├── types/
│   │   │   │   ├── admin.ts
│   │   │   │   └── api.ts
│   │   │   ├── App.tsx
│   │   │   └── main.tsx
│   │   ├── package.json
│   │   └── vite.config.ts
│   └── backend/             # 管理员后端
│       ├── src/
│       │   ├── controllers/ # 控制器
│       │   │   ├── authController.ts
│       │   │   ├── spotsController.ts
│       │   │   ├── islandsController.ts
│       │   │   └── uploadController.ts
│       │   ├── models/      # 数据模型
│       │   │   ├── User.ts
│       │   │   ├── Spot.ts
│       │   │   ├── Island.ts
│       │   │   └── FileRecord.ts
│       │   ├── routes/      # 路由定义
│       │   │   ├── auth.ts
│       │   │   ├── spots.ts
│       │   │   ├── islands.ts
│       │   │   └── upload.ts
│       │   ├── middleware/  # 中间件
│       │   │   ├── auth.ts
│       │   │   ├── upload.ts
│       │   │   └── validation.ts
│       │   ├── services/    # 业务逻辑
│       │   │   ├── authService.ts
│       │   │   ├── dataService.ts
│       │   │   └── fileService.ts
│       │   ├── utils/       # 工具函数
│       │   │   ├── database.ts
│       │   │   ├── jwt.ts
│       │   │   └── fileHelpers.ts
│       │   ├── types/       # 类型定义
│       │   │   ├── models.ts
│       │   │   └── requests.ts
│       │   ├── config/      # 配置文件
│       │   │   ├── database.ts
│       │   │   └── server.ts
│       │   └── app.ts       # 应用入口
│       ├── uploads/         # 上传文件目录
│       │   ├── images/
│       │   └── audio/
│       ├── package.json
│       └── tsconfig.json
├── package.json
├── vite.config.ts
├── tsconfig.json
├── README.md
├── start.sh                 # 一键启动脚本
└── 网站设计思路.txt📋 任务拆分与实现顺序
阶段一：项目基础搭建（优先级：高）
1. 项目环境初始化
    ◦ 创建React+TypeScript项目
    ◦ 配置Vite构建工具
    ◦ 安装必要依赖
    ◦ 设置项目基础配置
2. 数据结构设计
    ◦ 设计岛屿数据格式
    ◦ 设计打卡点数据格式
    ◦ 创建配置文件结构
    ◦ 设置TypeScript类型定义
3. 一键启动脚本
    ◦ 端口占用检测和清理
    ◦ 依赖安装检查
    ◦ 开发服务器启动
    ◦ 错误处理机制
阶段二：核心页面开发（优先级：高）
1. 首页界面
    ◦ 中间是一本日记
    ◦ CG背景图片集成
    ◦ 悬停动画效果
2. 主布局组件
    ◦ 导航栏设计
    ◦ 页面路由配置
    ◦ 面包屑导航
    ◦ 返回按钮功能
3. 交通篇占位页面
    ◦ "准备中，敬请期待"展示
    ◦ 简约页面设计
    ◦ 返回导航功能
阶段三：地图功能实现（优先级：高）
1. 打卡篇总览地图
    ◦ Google Maps API集成
    ◦ 三岛屿（女木岛、男木岛、直岛）标记
    ◦ 地图交互逻辑
    ◦ 岛屿点击事件处理
2. 岛屿详细页面
    ◦ 单岛屿地图显示
    ◦ 打卡点标记功能
    ◦ 地图缩放和平移控制
    ◦ 岛屿信息展示
3. 打卡点悬停信息
    ◦ 鼠标悬停事件处理
    ◦ 信息提示框设计
    ◦ 游戏地名和实际地名显示
    ◦ 简要介绍文字
阶段四：交互功能增强（优先级：中）
1. 打卡点详情页面
    ◦ 详细信息展示界面
    ◦ 游戏CG和实拍照片对比
    ◦ 文字描述和介绍
    ◦ 页面切换动画
2. BGM播放功能
    ◦ 音频播放器组件
    ◦ 自动播放控制
    ◦ 音量调节功能
    ◦ 播放状态管理
3. 图片展示功能
    ◦ 图片预览组件
    ◦ 游戏CG和实拍对比
    ◦ 图片缩放查看
    ◦ 轮播切换功能
阶段五：用户体验优化（优先级：中）
1. 响应式设计
    ◦ 移动端适配
    ◦ 平板设备优化
    ◦ 触摸交互支持
    ◦ 不同屏幕尺寸适配
2. 加载优化
    ◦ 图片懒加载
    ◦ 音频预加载
    ◦ 页面切换优化
    ◦ 错误边界处理
3. 交互体验
    ◦ 加载动画
    ◦ 过渡效果
    ◦ 用户反馈提示
    ◦ 操作引导
阶段六：管理员系统开发（优先级：中）
1. 后端基础搭建
    ◦ Node.js + Express API服务器
    ◦ 数据库连接和模型设计
    ◦ JWT认证系统
    ◦ 文件上传中间件
2. 数据库模型设计
    ◦ 用户认证模型
    ◦ 岛屿数据模型
    ◦ 打卡点数据模型
    ◦ 文件记录模型
3. 管理员认证系统
    ◦ 登录界面设计
    ◦ JWT token管理
    ◦ 权限验证中间件
    ◦ 会话状态管理
4. 打卡点管理功能
    ◦ 打卡点列表展示
    ◦ 地图上添加/删除标记
    ◦ 打卡点信息编辑
    ◦ 图片上传和替换
5. 岛屿管理功能
    ◦ 岛屿信息编辑
    ◦ 岛屿图片管理
    ◦ 岛屿关联打卡点管理
6. 文件管理系统
    ◦ 图片文件上传
    ◦ 音频文件上传
    ◦ 文件删除和替换
    ◦ 文件预览功能
7. 管理员仪表板
    ◦ 数据统计展示
    ◦ 快捷操作面板
    ◦ 系统状态监控
阶段七：项目完善（优先级：低）
1. 文档编写
    ◦ README使用说明
    ◦ 开发文档
    ◦ 部署指南
    ◦ API接口文档
🗺 数据结构设计
数据库模型设计 (MongoDB Schema)
用户模型 (User Collection)
interface User {
  _id: ObjectId;
  username: string;
  email: string;
  password: string; // 加密存储
  role: 'admin' | 'super_admin';
  createdAt: Date;
  updatedAt: Date;
  lastLogin?: Date;
}岛屿模型 (Island Collection)
interface Island {
  _id: ObjectId;
  id: string; // 唯一标识符
  name: string;
  gameName: string;
  description: string;
  introduction: string;
  position: {
    lat: number;
    lng: number;
  };
  zoomLevel: number;
  coverImage: string; // 图片文件路径
  spots: ObjectId[]; // 关联的打卡点ID数组
  isActive: boolean;
  createdAt: Date;
  updatedAt: Date;
  createdBy: ObjectId; // 创建者用户ID
}打卡点模型 (Spot Collection)
interface Spot {
  _id: ObjectId;
  id: string; // 唯一标识符
  islandId: ObjectId; // 所属岛屿ID
  gameName: string;
  realName: string;
  description: string;
  gameDescription: string;
  position: {
    lat: number;
    lng: number;
  };
  images: {
    cg: string; // CG图片路径
    real: string[]; // 实拍图片路径数组
    thumbnail: string; // 缩略图路径
  };
  audio: {
    bgm?: string; // BGM文件路径
    description?: string;
  };
  tips?: string;
  accessibility?: string;
  tags: string[];
  isActive: boolean;
  visitCount: number; // 访问统计
  createdAt: Date;
  updatedAt: Date;
  createdBy: ObjectId; // 创建者用户ID
}文件记录模型 (FileRecord Collection)
interface FileRecord {
  _id: ObjectId;
  originalName: string; // 原始文件名
  filename: string; // 存储文件名
  mimetype: string; // 文件类型
  size: number; // 文件大小
  path: string; // 文件存储路径
  url: string; // 访问URL
  category: 'image' | 'audio'; // 文件分类
  subcategory: 'cg' | 'real' | 'cover' | 'bgm' | 'ui'; // 子分类
  relatedId?: ObjectId; // 关联的数据ID（岛屿或打卡点）
  relatedType?: 'island' | 'spot'; // 关联的数据类型
  uploadedBy: ObjectId; // 上传者用户ID
  createdAt: Date;
}前端缓存数据结构
岛屿数据结构 (islands.json)
{
  "islands": [
    {
      "id": "onagishima",
      "name": "女木岛",
      "gameName": "游戏中的岛屿名称",
      "description": "岛屿详细介绍",
      "position": {
        "lat": 34.3836,
        "lng": 134.0947
      },
      "zoomLevel": 14,
      "spots": ["spot_onagi_1", "spot_onagi_2"],
      "coverImage": "/images/islands/onagishima-cover.jpg",
      "introduction": "女木岛的详细介绍文字..."
    },
    {
      "id": "ogishima", 
      "name": "男木岛",
      "gameName": "游戏中的岛屿名称",
      "description": "岛屿详细介绍",
      "position": {
        "lat": 34.3875,
        "lng": 134.0906
      },
      "zoomLevel": 14,
      "spots": ["spot_ogi_1", "spot_ogi_2"],
      "coverImage": "/images/islands/ogishima-cover.jpg",
      "introduction": "男木岛的详细介绍文字..."
    },
    {
      "id": "naoshima",
      "name": "直岛", 
      "gameName": "游戏中的岛屿名称",
      "description": "岛屿详细介绍",
      "position": {
        "lat": 34.4607,
        "lng": 133.9925
      },
      "zoomLevel": 14,
      "spots": ["spot_nao_1", "spot_nao_2"],
      "coverImage": "/images/islands/naoshima-cover.jpg",
      "introduction": "直岛的详细介绍文字..."
    }
  ]
}打卡点数据结构 (spots.json)
{
  "spots": [
    {
      "id": "spot_onagi_1",
      "islandId": "onagishima",
      "gameName": "游戏中的地点名称",
      "realName": "实际地点名称",
      "description": "打卡点详细介绍",
      "gameDescription": "游戏中的场景介绍",
      "position": {
        "lat": 34.3840,
        "lng": 134.0950
      },
      "images": {
        "cg": "/images/cg/spot_onagi_1_cg.jpg",
        "real": [
          "/images/real/spot_onagi_1_real_1.jpg",
          "/images/real/spot_onagi_1_real_2.jpg"
        ],
        "thumbnail": "/images/thumbnails/spot_onagi_1_thumb.jpg"
      },
      "audio": {
        "bgm": "/audio/bgm/spot_onagi_1_bgm.mp3",
        "description": "BGM曲目信息"
      },
      "tips": "拍摄建议和注意事项",
      "accessibility": "交通方式和开放时间",
      "tags": ["海滩", "夕阳", "主要场景"]
    }
  ]
}配置文件 (config.json)
{
  "googleMaps": {
    "defaultCenter": {
      "lat": 34.4,
      "lng": 134.0
    },
    "defaultZoom": 11,
    "mapStyles": "custom-style-id"
  },
  "audio": {
    "defaultVolume": 0.7,
    "autoPlay": false,
    "fadeInDuration": 2000
  },
  "ui": {
    "animationDuration": 300,
    "tooltipDelay": 500,
    "imagePreloadCount": 3
  }
}🎨 UI/UX 设计规范
色彩方案
• 主色调: 温暖的橙黄色（夏日主题）
• 辅助色: 海蓝色、天空蓝（海岛主题）
• 背景色: 米白色、浅灰色
• 文字色: 深棕色、深蓝色
字体选择
• 中文: 思源黑体、微软雅黑
• 英文: Roboto、Open Sans
• 标题: 书法字体（日记本风格）
交互设计
• 悬停效果: 轻微放大和阴影
• 点击反馈: 涟漪效果
• 页面切换: 淡入淡出过渡
• 加载状态: 旋转加载器
🚀 技术实现要点
Google Maps 集成
// 地图初始化配置
const mapOptions = {
  center: { lat: 34.4, lng: 134.0 },
  zoom: 11,
  mapTypeId: 'roadmap',
  styles: customMapStyles
};

// 标记点创建
const marker = new google.maps.Marker({
  position: spot.position,
  map: map,
  title: spot.gameName,
  icon: customMarkerIcon
});音频播放管理
// 音频控制器
class AudioController {
  private audio: HTMLAudioElement;
  
  play(src: string) {
    this.audio.src = src;
    this.audio.play();
  }
  
  fadeIn(duration: number) {
    // 淡入效果实现
  }
}响应式断点
/* 移动端 */
@media (max-width: 768px) {
  .map-container {
    height: 60vh;
  }
}

/* 平板 */
@media (min-width: 769px) and (max-width: 1024px) {
  .map-container {
    height: 70vh;
  }
}

/* 桌面端 */
@media (min-width: 1025px) {
  .map-container {
    height: 80vh;
  }
}🔐 管理员系统API设计
认证相关接口
// 用户登录
POST /api/admin/auth/login
Body: { email: string, password: string }
Response: { token: string, user: User }

// 验证token
GET /api/admin/auth/verify
Headers: { Authorization: "Bearer <token>" }
Response: { valid: boolean, user: User }

// 用户登出
POST /api/admin/auth/logout
Headers: { Authorization: "Bearer <token>" }
Response: { success: boolean }岛屿管理接口
// 获取所有岛屿
GET /api/admin/islands
Headers: { Authorization: "Bearer <token>" }
Response: { islands: Island[] }

// 创建岛屿
POST /api/admin/islands
Headers: { Authorization: "Bearer <token>" }
Body: Partial<Island>
Response: { island: Island }

// 更新岛屿
PUT /api/admin/islands/:id
Headers: { Authorization: "Bearer <token>" }
Body: Partial<Island>
Response: { island: Island }

// 删除岛屿
DELETE /api/admin/islands/:id
Headers: { Authorization: "Bearer <token>" }
Response: { success: boolean }打卡点管理接口
// 获取所有打卡点
GET /api/admin/spots?islandId=<id>&page=<num>&limit=<num>
Headers: { Authorization: "Bearer <token>" }
Response: { spots: Spot[], total: number, page: number }

// 创建打卡点
POST /api/admin/spots
Headers: { Authorization: "Bearer <token>" }
Body: Partial<Spot>
Response: { spot: Spot }

// 更新打卡点
PUT /api/admin/spots/:id
Headers: { Authorization: "Bearer <token>" }
Body: Partial<Spot>
Response: { spot: Spot }

// 删除打卡点
DELETE /api/admin/spots/:id
Headers: { Authorization: "Bearer <token>" }
Response: { success: boolean }

// 批量操作打卡点
POST /api/admin/spots/batch
Headers: { Authorization: "Bearer <token>" }
Body: { action: 'delete' | 'activate' | 'deactivate', ids: string[] }
Response: { success: boolean, affected: number }文件管理接口
// 上传文件
POST /api/admin/upload
Headers: { Authorization: "Bearer <token>" }
Content-Type: multipart/form-data
Body: FormData { file: File, category: string, subcategory: string, relatedId?: string, relatedType?: string }
Response: { file: FileRecord }

// 获取文件列表
GET /api/admin/files?category=<cat>&subcategory=<subcat>&page=<num>&limit=<num>
Headers: { Authorization: "Bearer <token>" }
Response: { files: FileRecord[], total: number, page: number }

// 删除文件
DELETE /api/admin/files/:id
Headers: { Authorization: "Bearer <token>" }
Response: { success: boolean }

// 替换文件
PUT /api/admin/files/:id/replace
Headers: { Authorization: "Bearer <token>" }
Content-Type: multipart/form-data
Body: FormData { file: File }
Response: { file: FileRecord }数据统计接口
// 获取仪表板统计数据
GET /api/admin/statistics
Headers: { Authorization: "Bearer <token>" }
Response: {
  totalIslands: number;
  totalSpots: number;
  totalFiles: number;
  totalVisits: number;
  recentActivity: Activity[];
  popularSpots: Spot[];
}

// 获取访问统计
GET /api/admin/analytics?period=<day|week|month>&startDate=<date>&endDate=<date>
Headers: { Authorization: "Bearer <token>" }
Response: {
  visits: { date: string, count: number }[];
  spotVisits: { spotId: string, spotName: string, count: number }[];
}📦 依赖包清单
核心依赖
• react - React框架
• react-dom - React DOM渲染
• react-router-dom - 路由管理
• typescript - TypeScript支持
• vite - 构建工具
UI和样式
• styled-components - CSS-in-JS
• @types/styled-components - TypeScript类型
• react-spring - 动画库
地图功能
• @googlemaps/js-api-loader - Google Maps加载器
• @types/google.maps - Google Maps类型定义
工具库
• axios - HTTP请求（如果需要）
• lodash - 工具函数库
• date-fns - 日期处理
后端依赖
• express - Web应用框架
• mongoose - MongoDB对象建模
• jsonwebtoken - JWT认证
• bcryptjs - 密码加密
• multer - 文件上传处理
• cors - 跨域资源共享
• helmet - 安全中间件
• express-rate-limit - 请求限流
• joi - 数据验证
• winston - 日志记录
• dotenv - 环境变量管理
🔧 开发和部署
一键启动脚本功能
#!/bin/bash
# start.sh

echo "🚀 启动 Summer Pockets 圣地巡礼网站..."

# 1. 检查并终止占用端口的进程
echo "📋 检查端口占用情况..."
lsof -ti:3000 | xargs kill -9 2>/dev/null || true  # 前端端口
lsof -ti:3001 | xargs kill -9 2>/dev/null || true  # 后端API端口
lsof -ti:3002 | xargs kill -9 2>/dev/null || true  # 管理员前端端口

# 2. 启动MongoDB（如果本地安装）
echo "🗄 检查MongoDB服务..."
if command -v mongod &> /dev/null; then
    if ! pgrep -x "mongod" > /dev/null; then
        echo "启动MongoDB服务..."
        sudo systemctl start mongod || mongod --fork --logpath /var/log/mongodb.log
    else
        echo "✅ MongoDB已运行"
    fi
else
    echo "⚠ 请确保MongoDB已安装并运行"
fi

# 3. 安装前端依赖
echo "📦 检查前端依赖..."
if [ ! -d "node_modules" ]; then
    echo "安装前端依赖..."
    npm install
else
    echo "✅ 前端依赖已存在"
fi

# 4. 安装后端依赖
echo "📦 检查后端依赖..."
cd admin/backend
if [ ! -d "node_modules" ]; then
    echo "安装后端依赖..."
    npm install
else
    echo "✅ 后端依赖已存在"
fi
cd ../..

# 5. 安装管理员前端依赖
echo "📦 检查管理员前端依赖..."
cd admin/frontend
if [ ! -d "node_modules" ]; then
    echo "安装管理员前端依赖..."
    npm install
else
    echo "✅ 管理员前端依赖已存在"
fi
cd ../..

# 6. 启动后端服务器
echo "🔧 启动后端API服务器..."
cd admin/backend
npm run dev &
BACKEND_PID=$!
cd ../..

# 7. 启动管理员前端
echo "🔧 启动管理员前端..."
cd admin/frontend
npm run dev &
ADMIN_FRONTEND_PID=$!
cd ../..

# 8. 启动主网站前端
echo "🌐 启动主网站前端..."
npm run dev &
FRONTEND_PID=$!

echo "✨ 所有服务已启动："
echo "   📱 主网站: http://localhost:3000"
echo "   🔧 管理员后台: http://localhost:3002"
echo "   🛠 API服务: http://localhost:3001"
echo ""
echo "按 Ctrl+C 停止所有服务"

# 9. 等待信号并清理进程
cleanup() {
    echo "🛑 正在停止所有服务..."
    kill $FRONTEND_PID 2>/dev/null || true
    kill $ADMIN_FRONTEND_PID 2>/dev/null || true
    kill $BACKEND_PID 2>/dev/null || true
    echo "✅ 所有服务已停止"
    exit 0
}

trap cleanup SIGINT SIGTERM

# 保持脚本运行
wait部署配置
• 开发环境: npm run dev
• 构建命令: npm run build
• 预览命令: npm run preview
• 静态托管: Vercel、Netlify、GitHub Pages
📝 开发注意事项
API密钥管理
• Google Maps API密钥需要环境变量配置
• 不要将密钥提交到版本控制
• 使用.env文件管理敏感信息
性能优化
• 图片压缩和WebP格式转换
• 音频文件压缩
• 代码分割和懒加载
• CDN资源加速
浏览器兼容性
• 支持现代浏览器（Chrome 80+, Firefox 75+, Safari 13+）
• 音频API兼容性处理
• 地图API降级方案
错误处理
• 网络请求失败处理
• 地图加载失败降级
• 音频播放失败提示
• 用户操作错误引导
管理员系统安全
• JWT token安全存储和刷新
• 文件上传类型和大小限制
• SQL注入和XSS攻击防护
• 请求频率限制和DDOS防护
• 数据备份和恢复策略
• 操作日志记录和审计
数据库设计注意事项
• 索引优化（位置查询、用户查询）
• 数据关联完整性约束
• 软删除vs硬删除策略
• 数据迁移脚本设计
• 备份策略和恢复测试
🎯 后续扩展计划
第二版功能
• 交通篇详细内容
• 用户评论系统
• 巡礼路线规划
• 社交分享功能
管理员系统扩展
• 多角色权限管理（超级管理员、内容管理员、审核员）
• 内容审核工作流
• 批量导入导出功能
• 数据可视化报表
• 实时监控面板
• 操作历史版本控制
• 内容发布预览和定时发布
• API接口文档自动生成
数据扩展
• 更多打卡点数据
• 季节性内容变化
• 多语言支持
• 用户生成内容
技术升级
• PWA支持
• 离线功能
• 推送通知
• 地理位置服务
---
该设计方案将根据开发进度和用户反馈持续更新优化